"use strict";(self["webpackChunksubscriptions"]=self["webpackChunksubscriptions"]||[]).push([[518],{2518:function(s,e,i){i.r(e),i.d(e,{default:function(){return G}});var t=i(3396),a=i(7139),n=i(9242),o=i(9289),c=i(5748);const r=s=>((0,t.dD)("data-v-782f217d"),s=s(),(0,t.Cn)(),s),d={class:"container wrapper"},l=r((()=>(0,t._)("span",{class:"info__title"}," Мой двор ",-1))),_={key:0},p={class:"info__warning"},u=r((()=>(0,t._)("span",null,"Недостаточно средств на вашем счете",-1))),f={class:"info__detail"},h={class:"info__detail_row"},b={class:"info__detail_date"},v={class:"info__detail_row"},m={class:"info__detail_price"},w=r((()=>(0,t._)("span",{class:"ruble"}," ₽ ",-1))),k={key:1},y={class:"info__detail"},I={class:"info__detail_row"},g={class:"info__detail_date"},M={key:2},C=r((()=>(0,t._)("div",{class:"info__warning"}," Недостаточно средств на вашем счете ",-1))),D={class:"info__detail"},E={class:"info__detail_row"},U={class:"info__detail_date"},P={class:"info__detail_row"},S={class:"info__detail_price"},A=r((()=>(0,t._)("span",{class:"ruble"}," ₽ ",-1))),$={key:3},z={class:"info__detail"},R={class:"info__detail_row"},F={class:"info__detail_date"},T={class:"info__detail_row"},H={class:"info__detail_price"},x=r((()=>(0,t._)("span",{class:"ruble"}," ₽ ",-1))),j={class:"info__services"},L=r((()=>(0,t._)("span",{class:"info__services_title-text"}," Подключенные услуги ",-1))),O={class:"service__name"},W={class:"service__price"},Y=r((()=>(0,t._)("span",{class:"ruble"}," ₽ ",-1))),B=r((()=>(0,t._)("img",{src:c,alt:"error",class:"modal__header_img"},null,-1)));function N(s,e,i,c,r,N){const V=(0,t.up)("Logo"),K=(0,t.up)("Btn"),Z=(0,t.up)("ModalWindow");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("div",d,[(0,t.Wm)(V,{disabled:!+s.subscriptionInfo.hasAccess},null,8,["disabled"]),l,(0,t._)("span",{class:(0,a.C_)(["info__status",{active:+s.subscriptionInfo.hasAccess}])}," Подписка "+(0,a.zw)(+s.subscriptionInfo.hasAccess?"активна":!+s.subscriptionInfo.hasAccess&&s.abonentInfo.hasSubscription?"неактивна":"заблокирована"),3),s.subscriptionInfo.creditTimeEnd?((0,t.wg)(),(0,t.iD)("div",_,[(0,t._)("div",p,[u,(0,t._)("span",null,(0,a.zw)(s.dataFormat(s.subscriptionInfo.creditTimeEnd))+" подписка будет заблокирована ",1)]),(0,t._)("div",f,[(0,t._)("div",h,[(0,t.Uk)(" Расчетный период "),(0,t._)("span",b,(0,a.zw)(s.dataFormat(s.subscriptionInfo.nextPayDate||s.subscriptionInfo.creditTimeEnd)),1)]),(0,t._)("div",v,[(0,t.Uk)(" Требуется оплата "),(0,t._)("span",m,[(0,t.Uk)((0,a.zw)(s.subscriptionInfo.payRecommended)+" ",1),w])])])])):+s.subscriptionInfo.hasAccess&&s.subscriptionInfo.endDate?((0,t.wg)(),(0,t.iD)("div",k,[(0,t._)("div",y,[(0,t._)("div",I,[(0,t.Uk)(" Подписка отменится "),(0,t._)("span",g,(0,a.zw)(s.dataFormat(s.subscriptionInfo.endDate)),1)])])])):!+s.subscriptionInfo.hasAccess&&s.balance<0?((0,t.wg)(),(0,t.iD)("div",M,[C,(0,t._)("div",D,[(0,t._)("div",E,[(0,t.Uk)(" Подписка будет отключена "),(0,t._)("span",U,(0,a.zw)(s.dataFormat(s.subscriptionInfo.nextPayDate||s.subscriptionInfo.creditTimeEnd||s.subscriptionInfo.endDate)),1)]),(0,t._)("div",P,[(0,t.Uk)(" Требуется оплата "),(0,t._)("span",S,[(0,t.Uk)((0,a.zw)(s.subscriptionInfo.payRecommended)+" ",1),A])])])])):((0,t.wg)(),(0,t.iD)("div",$,[(0,t._)("div",z,[(0,t._)("div",R,[(0,t.Uk)(" Расчетный период "),(0,t._)("span",F,(0,a.zw)(s.dataFormat(s.subscriptionInfo.nextPayDate||s.subscriptionInfo.creditTimeEnd||s.subscriptionInfo.endDate)),1)]),(0,t._)("div",T,[(0,t.Uk)(" Затем спишется "),(0,t._)("span",H,[(0,t.Uk)((0,a.zw)(s.subscriptionInfo.payRecommended)+" ",1),x])])])])),(0,t._)("div",j,[(0,t._)("div",{class:"info__services_title",onClick:e[0]||(e[0]=e=>s.servicesHidden=!s.servicesHidden)},[L,(0,t._)("img",{src:o,alt:"Свернуть",class:(0,a.C_)(["info__services_title-arrow",{opened:!s.servicesHidden}]),width:"24",height:"24"},null,2)]),(0,t._)("div",{class:(0,a.C_)(["info__services_list",{hidden:s.servicesHidden}])},[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.services,((s,e)=>((0,t.wg)(),(0,t.iD)("div",{key:s,class:"info__service"},[(0,t._)("span",O,(0,a.zw)(+e+1)+". "+(0,a.zw)("Видеонаблюдение"===s["SERVICE_NAME"]?"Камеры во дворе":"Умный домофон PRO"===s["SERVICE_NAME"]?"Умный домофон":s["SERVICE_NAME"]),1),(0,t._)("span",W,[(0,t.Uk)((0,a.zw)(s.PRICE[1])+" ",1),Y,(0,t.Uk)("/мес ")])])))),128))],2)])]),(0,t.wy)((0,t.Wm)(Z,{onClick:(0,n.iM)(s.closePayModal,["self"])},{title:(0,t.w5)((()=>[B,(0,t.Uk)(" Не удалось списать оплату ")])),description:(0,t.w5)((()=>[(0,t.Uk)(" Недостаточно средств на вашем счёте, подписка будет "+(0,a.zw)(s.subscriptionInfo.hasAccess?"отключена":"заблокирована")+" "+(0,a.zw)(s.dataFormat(s.subscriptionInfo.nextPayDate||s.subscriptionInfo.endDate)),1)])),footer:(0,t.w5)((()=>[(0,t.Wm)(K,{color:"gray",small:!0,onClick:s.closePayModal},{default:(0,t.w5)((()=>[(0,t.Uk)(" Отменить ")])),_:1},8,["onClick"]),(0,t.Wm)(K,{small:!0,onClick:e[1]||(e[1]=e=>(s.sendEventFromPayModal(),s.goToMerchant()))},{default:(0,t.w5)((()=>[(0,t.Uk)(" Пополнить ")])),_:1})])),_:1},8,["onClick"]),[[n.F8,s.payModalDisplay]])],64)}var V=i(9370),K=(0,t.aZ)({name:"SubscribeInfo",components:{Logo:(0,t.RC)((()=>i.e(469).then(i.bind(i,3469)))),ModalWindow:(0,t.RC)((()=>i.e(349).then(i.bind(i,5349)))),Btn:(0,t.RC)((()=>i.e(286).then(i.bind(i,8286))))},data(){return{servicesHidden:!1,sawPayModalCookie:!1,clicked:!1}},computed:{services(){let s=this.$store.state.formattedServices;return Object.filter=(s,e)=>Object.keys(s).filter((i=>e(s[i]))).reduce(((e,i)=>(e[i]=s[i],e)),{}),s=Object.filter(s,(s=>"1"===s.HAS_SERVICE)),s},abonentInfo(){return this.$store.state.abonentInfo},payModalDisplay(){return this.$store.state.payModalDisplay},subscriptionInfo(){return this.$store.state.subscriptionInfo},balance(){return this.$store.state.balance},payMethod(){return this.$store.state.payMethod}},watch:{services(s){this.servicesHidden=Object.keys(s).length>1}},async mounted(){await this.$store.dispatch("getSubscriptionInfo"),this.getSawPayModalCookie(),this.servicesHidden=Object.keys(this.services).length>1},methods:{dataFormat(s){return s?new Date(s).toLocaleString().slice(0,10):""},getSawPayModalCookie(){this.sawPayModalCookie=(0,V.sN)()},closePayModal(){this.setCookie(),this.$store.dispatch("changePayModalDisplay",!1),this.subscriptionInfo.hasAccess?this.$store.dispatch("sendUserEvent","YardSubManagementModuActivelClose"):this.$store.dispatch("sendUserEvent","YardSubManagementModuBlockCancel")},setCookie(){let s=this.subscriptionInfo.nextPayDate.split(".").reverse().join("-");s=new Date(s).toUTCString(),document.cookie=`saw_pay_modal=true; path=/; expires=${s}`},goToMerchant(){if(!this.clicked){let s="card"===this.payMethod?"SubscriptionPay":"PaymentFromLK",e=`isapp://lk?screen=${s}&sum=${this.subscriptionInfo.payRecommended}`;this.deepLinkImitator(e)}this.clicked=!0,setTimeout((()=>this.clicked=!1),2e3),this.$store.dispatch("changePayModalDisplay",!1)},deepLinkImitator(s){const e=document.createElement("a");e.setAttribute("href",s),e.click()},sendEventFromPayModal(){+this.subscriptionInfo.hasAccess?this.$store.dispatch("sendUserEvent","YardSubManagementModulActiveTopUp"):this.$store.dispatch("sendUserEvent","YardSubManagementModulBlockTopUp")}}}),Z=i(7477);const q=(0,Z.Z)(K,[["render",N],["__scopeId","data-v-782f217d"]]);var G=q},9289:function(s,e,i){s.exports=i.p+"img/arrow-back.48e9e372.svg"},5748:function(s,e,i){s.exports=i.p+"img/modal_error.2a620092.svg"}}]);
//# sourceMappingURL=518.539c3894.js.map